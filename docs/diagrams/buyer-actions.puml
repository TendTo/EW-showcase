@startuml Marketplace flow
title Marketplace flow
!theme cerulean

skinparam maxMessageSize 150
skinparam defaultTextAlignment center
skinparam noteTextAlignment left

actor "Buyer" as bu
participant "Marketplace" as ma

== Submit demand ==
bu->ma ++: Submit new/updated demand
ma->ma: Validate parameters
ma->ma: Check demand is unlocked
note over ma: Log new/updated demand
ma->bu --: Success

== Cancel demand ==
bu->ma ++: Cancel demand
ma->ma: Check demand is unlocked
note over ma: Log demand cancelled
ma->bu --: Success

== Reject match proposal ==
bu<--ma: Gather matches logs
bu->ma: Reject match proposal
ma->ma: Unlock offer and demand
ma->ma: Delete match
note over ma: Log match rejected
ma->bu: Success

== Delete match ==
bu<--ma: Gather matches logs
bu->ma ++: Reject match proposal
ma->ma: Unlock offer and demand
ma->ma: Delete match
note over ma: Log match deleted
ma->bu: Success
@enduml